{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/img/icon-error.svg","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nconst API_KEY = '46849389-2041d53e6d8b95dbaa186e245';\nconst BASE_URL = 'https://pixabay.com/api';\n\nlet page = 1;\nlet currentQuery = '';\n\nconst fetchImages = async query => {\n  if (currentQuery === query) {\n    page++;\n  } else {\n    page = 1;\n    currentQuery = query;\n  }\n\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: `${query}`,\n    page,\n    per_page: 15,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n  });\n\n  try {\n    const response = await axios.get(`${BASE_URL}/?${searchParams}`);\n    if (response.data.hits.length === 0) {\n      // iziToast.error({\n      //   message:\n      //     'Sorry, there are no images matching your search query. Please try again!',\n      // });\n      return null;\n    }\n\n    return { hits: response.data.hits, totalHits: response.data.totalHits };\n  } catch (error) {\n    throw error;\n  }\n};\n\nexport default fetchImages;\n","const createMarkup = arr => {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" /></a>\n      <div class=\"gallery-counters\">\n        <p>Likes<span>${likes}</span></p>\n        <p>Views<span>${views}</span></p>\n        <p>Comments<span>${comments}</span></p>\n        <p>Downloads<span>${downloads}</span></p>\n      </div>\n    </li>\n  `\n    )\n    .join('');\n};\n\nexport default createMarkup;\n","export default \"data:image/svg+xml,%3csvg%20width='24.000000'%20height='24.000000'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs/%3e%3cpath%20id='Vector'%20d='M6.81%200.21C6.95%200.07%207.14%206.1e-5%207.33%200L16.66%200C16.85%206.1e-5%2017.04%200.07%2017.18%200.21L23.78%206.81C23.92%206.95%2024%207.14%2024%207.33L24%2016.66C24%2016.85%2023.92%2017.04%2023.78%2017.19L17.18%2023.78C17.04%2023.92%2016.85%2023.99%2016.66%2024L7.33%2024C7.14%2023.99%206.95%2023.92%206.81%2023.78L0.21%2017.19C0.07%2017.04%200%2016.85%200%2016.66L0%207.33C0%207.14%200.07%206.95%200.21%206.81L6.81%200.21ZM7.65%201.5L1.5%207.65L1.5%2016.35L7.65%2022.5L16.35%2022.5L22.5%2016.35L22.5%207.65L16.35%201.5L7.65%201.5Z'%20fill='%23FAFAFB'%20fill-opacity='1.000000'%20fill-rule='nonzero'/%3e%3cpath%20id='Vector'%20d='M6.96%206.96C7.03%206.89%207.12%206.84%207.21%206.8C7.3%206.76%207.4%206.74%207.5%206.74C7.59%206.74%207.69%206.76%207.78%206.8C7.87%206.84%207.96%206.89%208.03%206.96L12%2010.93L15.96%206.96C16.03%206.89%2016.12%206.84%2016.21%206.8C16.3%206.76%2016.4%206.74%2016.5%206.74C16.59%206.74%2016.69%206.76%2016.78%206.8C16.87%206.84%2016.96%206.89%2017.03%206.96C17.1%207.03%2017.15%207.12%2017.19%207.21C17.23%207.3%2017.25%207.4%2017.25%207.5C17.25%207.59%2017.23%207.69%2017.19%207.78C17.15%207.87%2017.1%207.96%2017.03%208.03L13.06%2012L17.03%2015.96C17.1%2016.03%2017.15%2016.12%2017.19%2016.21C17.23%2016.3%2017.25%2016.4%2017.25%2016.5C17.25%2016.59%2017.23%2016.69%2017.19%2016.78C17.15%2016.87%2017.1%2016.96%2017.03%2017.03C16.96%2017.1%2016.87%2017.15%2016.78%2017.19C16.69%2017.23%2016.59%2017.25%2016.5%2017.25C16.4%2017.25%2016.3%2017.23%2016.21%2017.19C16.12%2017.15%2016.03%2017.1%2015.96%2017.03L12%2013.06L8.03%2017.03C7.96%2017.1%207.87%2017.15%207.78%2017.19C7.69%2017.23%207.59%2017.25%207.5%2017.25C7.4%2017.25%207.3%2017.23%207.21%2017.19C7.12%2017.15%207.03%2017.1%206.96%2017.03C6.89%2016.96%206.84%2016.87%206.8%2016.78C6.76%2016.69%206.74%2016.59%206.74%2016.5C6.74%2016.4%206.76%2016.3%206.8%2016.21C6.84%2016.12%206.89%2016.03%206.96%2015.96L10.93%2012L6.96%208.03C6.89%207.96%206.84%207.87%206.8%207.78C6.76%207.69%206.74%207.59%206.74%207.5C6.74%207.4%206.76%207.3%206.8%207.21C6.84%207.12%206.89%207.03%206.96%206.96Z'%20fill='%23FAFAFB'%20fill-opacity='1.000000'%20fill-rule='nonzero'/%3e%3c/svg%3e\"","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport fetchImages from './js/pixabay-api';\nimport createMarkup from './js/render-functions';\nimport iconError from './img/icon-error.svg';\n\nconst form = document.querySelector('.form');\nconst searchInput = form.querySelector('input[name=\"search\"]');\nconst imageList = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.more');\nconst loader = document.querySelector('.loader');\nloader.style.display = 'none';\n\niziToast.settings({\n  messageSize: 15,\n  messageColor: '#fff',\n  messageLineHeight: 20,\n  iconUrl: `${iconError}`,\n  position: 'topRight',\n  timeout: 7000,\n  closeOnClick: true,\n  maxWidth: 350,\n  backgroundColor: 'rgb(239, 64, 64)',\n});\n\nlet gallery = new SimpleLightbox('.gallery .gallery-link');\nlet searchValue = '';\nlet totalHits = 0;\n\nform.addEventListener('submit', handleSubmit);\nloadMoreBtn.addEventListener('click', () => createGallery());\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  searchValue = searchInput.value.trim();\n  loadMoreBtn.classList.add('hide');\n\n  if (!searchValue) {\n    iziToast.error({\n      message:\n        'Search field cannot be empty. Please enter a keyword to search.',\n    });\n    return;\n  }\n\n  imageList.innerHTML = '';\n  loader.style.display = 'block';\n\n  await createGallery();\n\n  console.log(totalHits);\n\n  if (totalHits > 15) {\n    loadMoreBtn.classList.remove('hide');\n  }\n\n  form.reset();\n}\n\nasync function createGallery() {\n  try {\n    const result = await fetchImages(searchValue);\n\n    if (!result) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      loader.style.display = 'none';\n      loadMoreBtn.classList.add('hide');\n      totalHits = 0;\n      return;\n    }\n\n    const { hits, totalHits: newTotalHits } = result;\n    totalHits = newTotalHits;\n\n    const markup = createMarkup(hits);\n    imageList.insertAdjacentHTML('beforeend', markup);\n    gallery.refresh();\n\n    const { height: cardHeight } = document\n      .querySelector('.gallery')\n      .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    if (imageList.children.length >= totalHits) {\n      loadMoreBtn.classList.add('hide');\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (err) {\n    iziToast.error({\n      message: `As error occured: ${err.message}`,\n    });\n    loadMoreBtn.classList.add('hide');\n  } finally {\n    loader.style.display = 'none';\n  }\n}\n"],"names":["API_KEY","BASE_URL","page","currentQuery","fetchImages","query","searchParams","response","axios","error","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iconError","form","searchInput","imageList","loadMoreBtn","loader","iziToast","gallery","SimpleLightbox","searchValue","totalHits","handleSubmit","createGallery","event","result","hits","newTotalHits","markup","cardHeight","err"],"mappings":"owBAIA,MAAMA,EAAU,qCACVC,EAAW,0BAEjB,IAAIC,EAAO,EACPC,EAAe,GAEnB,MAAMC,EAAc,MAAMC,GAAS,CAC7BF,IAAiBE,EACnBH,KAEAA,EAAO,EACPC,EAAeE,GAGjB,MAAMC,EAAe,IAAI,gBAAgB,CACvC,IAAKN,EACL,EAAG,GAAGK,CAAK,GACX,KAAAH,EACA,SAAU,GACV,WAAY,QACZ,YAAa,aACb,WAAY,EAChB,CAAG,EAED,GAAI,CACF,MAAMK,EAAW,MAAMC,EAAM,IAAI,GAAGP,CAAQ,KAAKK,CAAY,EAAE,EAC/D,OAAIC,EAAS,KAAK,KAAK,SAAW,EAKzB,KAGF,CAAE,KAAMA,EAAS,KAAK,KAAM,UAAWA,EAAS,KAAK,UAC7D,OAAQE,EAAO,CACd,MAAMA,CACP,CACH,EC1CMC,EAAeC,GACZA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA,sCAE0BL,CAAa,eAAeD,CAAY,UAAUE,CAAI;AAAA;AAAA,wBAEpEC,CAAK;AAAA,wBACLC,CAAK;AAAA,2BACFC,CAAQ;AAAA,4BACPC,CAAS;AAAA;AAAA;AAAA,GAIhC,EACA,KAAK,EAAE,ECvBGC,EAAA,61ECQTC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAcD,EAAK,cAAc,sBAAsB,EACvDE,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAc,SAAS,cAAc,OAAO,EAC5CC,EAAS,SAAS,cAAc,SAAS,EAC/CA,EAAO,MAAM,QAAU,OAEvBC,EAAS,SAAS,CAChB,YAAa,GACb,aAAc,OACd,kBAAmB,GACnB,QAAS,GAAGN,CAAS,GACrB,SAAU,WACV,QAAS,IACT,aAAc,GACd,SAAU,IACV,gBAAiB,kBACnB,CAAC,EAED,IAAIO,EAAU,IAAIC,EAAe,wBAAwB,EACrDC,EAAc,GACdC,EAAY,EAEhBT,EAAK,iBAAiB,SAAUU,CAAY,EAC5CP,EAAY,iBAAiB,QAAS,IAAMQ,EAAe,CAAA,EAE3D,eAAeD,EAAaE,EAAO,CAKjC,GAJAA,EAAM,eAAc,EACpBJ,EAAcP,EAAY,MAAM,OAChCE,EAAY,UAAU,IAAI,MAAM,EAE5B,CAACK,EAAa,CAChBH,EAAS,MAAM,CACb,QACE,iEACR,CAAK,EACD,MACD,CAEDH,EAAU,UAAY,GACtBE,EAAO,MAAM,QAAU,QAEvB,MAAMO,EAAa,EAEnB,QAAQ,IAAIF,CAAS,EAEjBA,EAAY,IACdN,EAAY,UAAU,OAAO,MAAM,EAGrCH,EAAK,MAAK,CACZ,CAEA,eAAeW,GAAgB,CAC7B,GAAI,CACF,MAAME,EAAS,MAAM7B,EAAYwB,CAAW,EAE5C,GAAI,CAACK,EAAQ,CACXR,EAAS,MAAM,CACb,QACE,0EACV,CAAO,EACDD,EAAO,MAAM,QAAU,OACvBD,EAAY,UAAU,IAAI,MAAM,EAChCM,EAAY,EACZ,MACD,CAED,KAAM,CAAE,KAAAK,EAAM,UAAWC,CAAY,EAAKF,EAC1CJ,EAAYM,EAEZ,MAAMC,EAAS1B,EAAawB,CAAI,EAChCZ,EAAU,mBAAmB,YAAac,CAAM,EAChDV,EAAQ,QAAO,EAEf,KAAM,CAAE,OAAQW,CAAU,EAAK,SAC5B,cAAc,UAAU,EACxB,kBAAkB,sBAAqB,EAE1C,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QAChB,CAAK,EAEGf,EAAU,SAAS,QAAUO,IAC/BN,EAAY,UAAU,IAAI,MAAM,EAChCE,EAAS,KAAK,CACZ,QAAS,4DACjB,CAAO,EAEJ,OAAQa,EAAK,CACZb,EAAS,MAAM,CACb,QAAS,qBAAqBa,EAAI,OAAO,EAC/C,CAAK,EACDf,EAAY,UAAU,IAAI,MAAM,CACpC,QAAY,CACRC,EAAO,MAAM,QAAU,MACxB,CACH"}